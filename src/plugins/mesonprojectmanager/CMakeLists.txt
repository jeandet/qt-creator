add_qtc_plugin(MesonProjectManager
  DEPENDS QmlJS
  PLUGIN_DEPENDS Core CppTools ProjectExplorer TextEditor QtSupport
  PLUGIN_RECOMMENDS Designer
  SOURCES
  mesonprojectplugin.cpp
  mesonprojectplugin.h
  MesonActionsManager/mesonactionsmanager.h
  MesonActionsManager/mesonactionsmanager.cpp
  MesonToolSettings/mesonsettingpage.h
  MesonToolSettings/mesonsettingpage.cpp
  MesonToolSettings/mesontoolsettingswidget.ui
  MesonToolSettings/mesontoolsettingswidget.h
  MesonToolSettings/mesontoolsettingswidget.cpp
  MesonToolSettings/mesontoolmodel.cpp
  MesonToolSettings/mesontoolmodel.h
  MesonToolSettings/mesonetooltreeitem.cpp
  MesonToolSettings/mesonetooltreeitem.h
  MesonToolSettings/mesontoolsettingaccessor.cpp
  MesonToolSettings/mesontoolsettingaccessor.h
  MesonToolSettings/mesontoolitemsettings.h
  MesonToolSettings/mesontoolitemsettings.ui
  MesonToolSettings/mesontoolitemsettings.cpp
  MesonToolSettings/mesontoolkitaspect.h
  MesonToolSettings/mesontoolkitaspect.cpp
  MesonToolSettings/mesontoolkitaspectwidget.h
  MesonToolSettings/mesontoolkitaspectwidget.cpp
  MesonWrapper/mesonwrapper.cpp
  MesonWrapper/mesonwrapper.h
  MesonWrapper/mesonnativefilegenerator.h
  MesonWrapper/mesonnativefilegenerator.cpp
  MesonInfoParser/mesoninfoparser.h
  MesonInfoParser/mesoninfoparser.cpp
  MesonProject/kithelper.h
  MesonProject/kitdata.h
  MesonProject/mesonproject.h
  MesonProject/mesonproject.cpp
  MesonProject/mesonprojectimporter.h
  MesonProject/mesonprojectimporter.cpp
  MesonProject/mesonbuildsystem.h
  MesonProject/mesonbuildsystem.cpp
  MesonProject/mesonprojectparser.h
  MesonProject/mesonprojectparser.cpp
  MesonProject/mesonbuildconfiguration.h
  MesonProject/mesonbuildconfiguration.cpp
  MesonProject/mesonbuildstep.h
  MesonProject/mesonbuildstep.cpp
  MesonProject/mesonbuildstepconfigwidget.ui
  MesonProject/mesonbuildstepconfigwidget.h
  MesonProject/mesonbuildstepconfigwidget.cpp
  MesonProject/mesonbuildsettingswidget.ui
  MesonProject/mesonbuildsettingswidget.h
  MesonProject/mesonbuildsettingswidget.cpp
  MesonProject/OptionsModel/buidoptionsmodel.h
  MesonProject/OptionsModel/buidoptionsmodel.cpp
  MesonProject/mesonprocess.h
  MesonProject/mesonprocess.cpp
  MesonProject/mesonoutputparser.h
  MesonProject/mesonoutputparser.cpp
  MesonProject/mesonrunconfiguration.h
  MesonProject/mesonrunconfiguration.cpp
  MesonProject/ProjectTree/projecttree.h
  MesonProject/ProjectTree/projecttree.cpp
  MesonProject/ProjectTree/mesonprojectnodes.h
  MesonProject/ProjectTree/mesonprojectnodes.cpp
  ressources.qrc
)

if(WITH_TESTS)
add_qtc_test(tst_mesonwrapper
  INCLUDES
    BEFORE "."
  DEPENDS
    Qt5::Core Qt5::Test Core
    Utils
  DEFINES
     MESON_SAMPLES_DIR="${CMAKE_CURRENT_SOURCE_DIR}/Tests/resources"
     MESON_SAMPLES_BUILD_DIR="${CMAKE_CURRENT_BINARY_DIR}"
  SOURCES
    Tests/testmesonwrapper.cpp
    MesonWrapper/mesonwrapper.cpp
    MesonWrapper/mesonwrapper.h
)

add_qtc_test(tst_mesoninfoparser
  INCLUDES
    BEFORE "."
  DEPENDS
    Qt5::Core Qt5::Test Core
    Utils
  DEFINES
     MESON_SAMPLES_DIR="${CMAKE_CURRENT_SOURCE_DIR}/Tests/resources"
     MESON_SAMPLES_BUILD_DIR="${CMAKE_CURRENT_BINARY_DIR}"
  SOURCES
    Tests/testmesoninfoparser.cpp
    MesonWrapper/mesonwrapper.cpp
    MesonWrapper/mesonwrapper.h
    MesonInfoParser/mesoninfoparser.h
    MesonInfoParser/mesoninfoparser.cpp
)
endif(WITH_TESTS)
